<template>
<div class="page" data-name="notification">
  <!-- Top Navbar -->
	 <div class="navbar pgradback navborder" >
      <div class="navbar-inner sliding">
        <div class="left">
          <a href="/pmainhome/" class="link">
            <i class="ion ion-md-notifications whitecolor"></i>
            <span class="ios-only">Back</span>
          </a>
        </div>
        <div class="title sliding titlehd whitecolor">Notification</div>
		<div class="right">
        </div>
      </div>
    </div>
  <!-- Top Navbar -->
  <div class="toolbar tabbar-labels toolbar-bottom-md customtoolbar">
    <div class="toolbar-inner">
      <a href="/pmainhome/" class="tab-link tab-link-active activeborder">
			<i class="ion ion-ios-pulse" style="font-size:x-large;"></i>
            <span class="tabbar-label badgefont">Explore</span>
	  </a>
      <a href="/pservice/" class="tab-link">
			<i class="ion ion-ios-medkit icontab"></i>
            <span class="tabbar-label badgefont">Booking</span>
	  </a>
	  <a href="/pupayment/" class="tab-link">
			<i class="ion ion-ios-card icontab"></i>
            <span class="tabbar-label badgefont">Wallet</span>
	  </a>
      <a href="/paccount/" class="tab-link">
			<i class="ion ion-ios-switch icontab"></i>
            <span class="tabbar-label badgefont">Account</span>
	  </a>
    </div>
  </div>
  <div class="tabs">
    <div id="tab-1" class="page-content tab tab-active bodybg">
	
	
	
	
	<div class="block">
	
		
		<span id="lclalertData">
		
				 <div style="height:150px !important"><center><p><img src="./img/imgspinner.gif" width="100px" height="100px"></p></center></div>
					
		</span>
		
		<!--
		<div class="col bluecolor2 boxcol block" style="margin:10px 0px;">
				<div class="row" style="padding-top: 10px;padding-bottom: 10px;">
				<div class="col-90" style="font-size:medium;color:black;">
				You received a payment for completion of eye care service ID:25d4fd2
				<br><span class="greencolor" style="font-size:small">May 12th, 2020 | 15:20</span>
				</div>
				<div class="col-10" style="font-size:medium;text-align:right"> <i class="ion ion-ios-text" style="color: #007cff;"></i></div>
				</div>
				
		</div>
		
		<div class="col bluecolor2 boxcol block" style="margin:10px 0px;">
				<div class="row" style="padding-top: 10px;padding-bottom: 10px;">
				<div class="col-90" style="font-size:medium;color:black;">
				You received a payment for completion of eye care service ID:5454fd2
				<br><span class="greencolor" style="font-size:small">May 11th, 2020 | 7:20</span>
				</div>
				<div class="col-10" style="font-size:medium;text-align:right"> <i class="ion ion-ios-text" style="color: #007cff;"></i></div>
				</div>
				
		</div>
		
		<div class="col bluecolor2 boxcol block" style="margin:10px 0px;">
				<div class="row" style="padding-top: 10px;padding-bottom: 10px;">
				<div class="col-90" style="font-size:medium;color:black;">
				Your withdrawal was approved for N5,000 and amount credited to your Account
				<br><span class="greencolor" style="font-size:small">May 10th, 2020 | 18:20</span>
				</div>
				<div class="col-10" style="font-size:medium;text-align:right"> <i class="ion ion-ios-text" style="color: #c1c1c1;"></i></div>
				</div>
				
		</div>
		
		<div class="col bluecolor2 boxcol block" style="margin:10px 0px;">
				<div class="row" style="padding-top: 10px;padding-bottom: 10px;">
				<div class="col-90" style="font-size:medium;color:black;">
				Your withdrawal was approved for N3,000 and amount credited to your Account
				<br><span class="greencolor" style="font-size:small">May 10th, 2020 | 22:20</span>
				</div>
				<div class="col-10" style="font-size:medium;text-align:right"> <i class="ion ion-ios-text" style="color: #c1c1c1;"></i></div>
				</div>
				
		</div>
		
		-->
		
		
		<br>
		<br>
		
		
		
		
		
	   </div>
	

           
          
    </div>
    <div id="tab-2" class="page-content tab">
      <div class="block">
        <p>Tab 2 content</p>
        
      </div>
    </div>
    <div id="tab-3" class="page-content tab">
      <div class="block">
        <p>Tab 3 content</p>
        
      </div>
    </div>
  </div>
  
 
  
  
  
</div>
</template>
<style>
.listline
{
border-bottom: 1px solid #e5e5e5;
color:#034679;
}
.textsmall
{
font-size:small;
text-align: justify;
}
.iconform
{
color: #e62b1e; !important
font-size: x-large;
}
.frmtxt
{font-size:16px;}
.divspinner
{background:transparent url('./img/imgspinner.gif') center no-repeat;}
.md .navbar:after
{height:0px;}
.md .color-theme-red .toolbar:not(.messagebar), .md .color-theme-red.toolbar:not(.messagebar)
{background: #ffffff;}
.md .tabbar a.tab-link.active-state, .md .tabbar a.tab-link.tab-link-active, .md .tabbar-labels a.tab-link.active-state, .md .tabbar-labels a.tab-link.tab-link-active
{color: #346d9a;}
.md .item-input-wrap:after
{background-color:#e3e1e1;}
.md .toolbar a
{color: #f44336;}
.md .color-theme-red .input-after:after, .md .color-theme-red .item-input-focused .item-input-wrap:after
{background: #e3e1e1;}
.md .list
{margin: 10px 0;}
.iptborder
{background:#e3e1e1;border-radius:10px;}
.boxcol
{border-radius: 10px;background: #ffffff none repeat scroll 0 0;box-shadow: 0 5px 20px 0 rgba(0,0,0,0.15);margin:15px 0;}
.alnright
{float: right;}
.customli2
{border-bottom: 1px solid #e0e0e0;font-size:16px !important;}
</style>
<script>
return {
	methods:{
	iptSearch: function () {
	
	var fullName = $$('#fullName').val();
	app.dialog.alert('Inputed '+ fullName);
	
	},
	getCode: function () {
	
		var userPhone = localStorage.getItem("lcluserPhone");
		var url = app.data.appconst.url;
		var constr = app.data.appconst.constr;
		
		app.toastBottom =  app.toast.create({
			text: 'Please wait...',
			closeTimeout: 2000,
		  })
		// Open it
		app.toastBottom.open();
		
		//Call server and send code
		app.request({
				url: url+'Phoneverify/getcode/',
				dataType:'json',
				method: 'GET',
				data:{
				authid: constr,
				userPhone:userPhone
				},
				crossDomain:true,
				success:function(adata){
				 
				 
				 if(adata.status == "Success")
					{
						localStorage.setItem("lclotpCode", adata.otpCode);
						app.toastBottom =  app.toast.create({
							text: adata.message,
							closeTimeout: 3000,
						  })
						// Open it
						app.toastBottom.open();
					
					}
					else
					{
						//app.dialog.alert(adata.message);
						app.toastBottom =  app.toast.create({
							text: adata.message,
							closeTimeout: 3000,
						  })
						// Open it
						app.toastBottom.open();
					}
					  
				},
				error:function(error){
				//console.log(error.code);
				console.log(error);
					//if(!navigator.onLine) { }
						app.toastBottom =  app.toast.create({
							text: 'An Error Occurred, Please check connection!',
							closeTimeout: 3000,
						  })
						// Open it
						app.toastBottom.open();
						
						//else
						//{app.dialog.alert('An Error Occurred!'+error.response);}
				
				},
				complete:function(){
				//Close Dialog
				//setTimeout(function () {app.dialog.close();}, 1000);
				//app.dialog.alert('An Error Occurred!'+error.response); 
				
				
				}
			});
		
		
		
	
		},
	submitCode: function () {
	
		var vCode = $$('#vCode').val();
		var url = app.data.appconst.url;
		var constr = app.data.appconst.constr;
		var userPhone = localStorage.getItem("lcluserPhone");
	
		if (!vCode){
		  app.dialog.alert('Enter Verification Code!');
		  return;
		 }
		 
		 //var lclotpCode = localStorage.getItem("lclotpCode");
		 
		  // Show Preloader
			app.dialog.progress();
		 
		 //Call server and send code
		app.request({
				url: url+'Phoneverify/',
				dataType:'json',
				method: 'GET',
				data:{
				authid: constr,
				vCode:vCode,
				userPhone:userPhone
				},
				crossDomain:true,
				success:function(adata){
				 
				 
				 if(adata.status == "Success")
					{
						localStorage.setItem("lclprovdInfo", adata.provdInfo);
						localStorage.setItem("lclverifyInfo", adata.verifyInfo);
						app.router.navigate('/pmainhome/');
						
						app.toastBottom =  app.toast.create({
							text: adata.message,
							closeTimeout: 3000,
						  })
						// Open it
						app.toastBottom.open();
					
					}
					else
					{
						//app.dialog.alert(adata.message);
						app.toastBottom =  app.toast.create({
							text: adata.message,
							closeTimeout: 3000,
						  })
						// Open it
						app.toastBottom.open();
					}
					  
				},
				error:function(error){
				//console.log(error.code);
				console.log(error);
					//if(!navigator.onLine) { }
						app.toastBottom =  app.toast.create({
							text: 'An Error Occurred, Please check connection!',
							closeTimeout: 3000,
						  })
						// Open it
						app.toastBottom.open();
						
						//else
						//{app.dialog.alert('An Error Occurred!'+error.response);}
				
				},
				complete:function(){
				//Close Dialog
				setTimeout(function () {app.dialog.close();}, 1000);
				//app.dialog.alert('An Error Occurred!'+error.response); 
				
				
				}
			});
		
	
		},
			},
	on: {
      pageInit: function (e, page) {
		
		//var lclprovdInfo = localStorage.getItem("lclprovdInfo");
		
		//document.getElementById("lclprovdInfoData2").innerHTML = lclprovdInfo;
		
		
        },
	  pageAfterIn: function(e, page) {
	  
		
		//show alert in local storage
		var lclalertData = localStorage.getItem("lclalertData");
		
		if (lclalertData)
			{
				setTimeout(function () {document.getElementById("lclalertData").innerHTML = lclalertData;}, 2000);
			}
			else
			{
				var norecord = '<img src="img/no_record_found.png" style="width:100%;margin-top:40%">';
				setTimeout(function () {document.getElementById("lclalertData").innerHTML = norecord;}, 1000);
			}
		
		
		//update read based on sno and check for new ones if lastsno is not the same
		var url = app.data.appconst.url;
		var constr = app.data.appconst.constr;
		var userPhone = localStorage.getItem("lcluserPhone");
		var alertSno = localStorage.getItem("lclalertSno");
	
		 
		 //var lclotpCode = localStorage.getItem("lclotpCode");
		 localStorage.setItem("lclalertNum", 0);
		
		 
		 //Call server and send code
		app.request({
				url: url+'Notify/update/',
				dataType:'json',
				method: 'GET',
				data:{
				authid: constr,
				alertSno:alertSno,
				userPhone:userPhone
				},
				crossDomain:true,
				success:function(adata){
				 
				 
				 if(adata.status == "Success")
					{
						localStorage.setItem("lclalertData", adata.lclalertData);
						
						
						if (adata.lclalertSno != alertSno)
						{
							setTimeout(function () {document.getElementById("lclalertData").innerHTML = adata.lclalertData;}, 3000);
						}
						
						localStorage.setItem("lclalertSno", adata.lclalertSno);
						localStorage.setItem("lclalertNum", adata.lclalertNum);
						
						app.toastBottom =  app.toast.create({
							text: adata.message,
							closeTimeout: 3000,
						  })
						// Open it
						//app.toastBottom.open();
					
					}
					else
					{
						//app.dialog.alert(adata.message);
						app.toastBottom =  app.toast.create({
							text: adata.message,
							closeTimeout: 3000,
						  })
						// Open it
						//app.toastBottom.open();
					}
					  
				},
				error:function(error){
				//console.log(error.code);
				console.log(error);
					//if(!navigator.onLine) { }
						app.toastBottom =  app.toast.create({
							text: 'An Error Occurred, Please check connection!',
							closeTimeout: 3000,
						  })
						// Open it
						app.toastBottom.open();
						
				
				},
				complete:function(){				
				}
			});
		
		//update read based on last sno
			//set alert number to zero
		
		
		
	  
	  },
      pageBeforeRemove() {
      },
    }


}

</script>
